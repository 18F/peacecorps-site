<div class="full_bg full_bg--lg" style="
    background-image: url('{{project.featured_image.url}}');
  ">
</div>
<article>
  {# TODO Figure out way to remove these inlines to global css #}
  <section style="min-height: 38em; padding-top: 6em;">
    <section class="full_banner full_banner--support_color">
      <div class="showcase showcase--shift_sm">
        <h1 class="t-heading--white t--no_bm">{{project.title}}</h1>
        <h2 class="t-heading--white">{{project.tagline}}</h2>
      </div>
    </section>
  </section>

  <div class="showcase--neutral">
    <div class="showcase showcase--col3_centered u-clearfix">
      <p class="t-bold">{{project.title}}</p>
      <section class="showcase--col3_centered__col">
        {% if project.volunteerpicture %}
          <div class="mask mask--oval u-h_center--block">
            <img class="mask__content"
                 src="{{project.volunteerpicture.url}}"
                 alt="{{project.volunteerpicture.description}}">
          </div>
        {% endif %}
        <span><strong>{{project.volunteername}}</strong><br>
          volunteer from <strong>{{project.volunteerhomestate}}</strong>
        </span>
      </section>
      <section class="showcase--col3_centered__col">
        <div class="mask mask--oval mask--bordered u-h_center--block map">
          <object class="mask__content js-worldMap"
                  id="js-worldMap"
                  type="image/svg+xml"
                  data="{{ static("peacecorps/img/BlankMap-World6.svg") }}">
          </object>
        </div>
      </section>
      <section class="showcase--col3_centered__col">
        {% set funded_percent = project.account.percent_funded() %}
        <div class="funded-chart">
          <div class="funded-amount-bar" style="max-width: {{funded_percent }}%;">
            &nbsp;
          </div>

          <div class="radial_progress">
          </div>

          <p class="funded-amount-text">
            {{ funded_percent|round|int }}% funded
          </p>
        </div>
        <p>Funds sought: <strong>${{project.account.goal/100}}</strong></p>
      </section>
    </div>
  </div>
</article>

{% macro map_js(country_code) %}
  var map,
      selectedCountry,
      selectedCountryCode = '',
      selectedCountryCoords = {};

  map = document.getElementById('js-worldMap')
    .contentDocument
    .querySelectorAll('svg')[0];

  {# TODO map 3 letter codes to 2 letter codes #}
  selectedCountryCode = '{{country_code.lower()|escapejs}}';
  hightLightCountry(selectedCountryCode);

  selectedCountry = map.getElementById(selectedCountryCode);
  selectedCountryCoords = selectedCountry.getBBox();
  setMapViewBox(selectedCountryCoords, map);

  function hightLightCountry(countryCode) {
    var countryPaths = [],
        path = {},
        i, ilen;

    countryPaths = map.querySelectorAll('.' + countryCode);
    for (i = 0, ilen = countryPaths.length; i < ilen; i++) {
      path = countryPaths[i];
      if (path.classList) {
        path.classList.add('world_map-is_selected');
      } else {
        el.className += ' ' + 'world_map-is_selected';
      }
    }
  }

  function setMapViewBox(coords, map) {
    // TODO scaling factor is arbituary, have to check how well it works for
    // all countries.
    var factor = 80;
    coords.x = parseFloat(coords.x, 10) - factor;
    coords.y = parseFloat(coords.y, 10) - factor;
    coords.width = parseFloat(coords.width, 10) + factor;
    coords.height = parseFloat(coords.height, 10) + factor;
    map.setAttribute('viewBox',
      coords.x + ' ' +
      coords.y + ' ' +
      coords.width + ' ' +
      coords.height)
  }
{% endmacro %}
