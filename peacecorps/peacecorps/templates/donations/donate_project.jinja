{% extends "donations/base.jinja" %}

{% block title %}Peace Corps - Donate{% endblock %}
{% block header %}Peace Corps - Donate{% endblock %}
{% block content_id %}project{% endblock %}

{% block navigation %}
<h2><a class="back" href="{{ url("donate issue", slug=project.issue.slug) }}">&lt;</a> {{project.title}}</h2>
{% endblock %}

{% block content %}
<p id="tagline">{{project.tagline}}</p>

<div id="featured-image">
  <img src="{{project.featured_image.url}}" alt="{{project.featured_image.description}}">
  <figcaption>{{project.featured_image.caption}}</figcaption>
</div>

<div id="donation-stats">
  {% if project.volunteerpicture %}
    <div id="volunteer-image">
      <img src="{{project.volunteerpicture.url}}"
           alt="{{project.volunteerpicture.description}}">
    </div>
  {% endif %}
  <div id="volunteer-info">
    <p><strong>{{project.volunteername}}</strong> from <strong>{{project.volunteerhomecity}}, {{project.volunteerhomestate}}</strong></p>
    {% set funded_percent = project.fund.percent_funded() %}
    <div id="funded-chart">
      <div id="funded-amount-bar" style="max-width: {{funded_percent }}%;">&nbsp;</div>
      <div id="funded-amount-text">{{ funded_percent|round|int }}% funded</div>
    </div>
    <p>Funds sought: <strong>${{project.fund.fundgoal/100}}</strong></p>

    <div id="donate-container"><button>
    {% if project.fund.funded() %}Donate to help similar projects {% else %}Donate{% endif %}
    </button></div>
  </div>
</div>

<form method="post">
  {% csrf_token %}
  <div id="radio-container">
    {{form.payment_amount.errors}}
    {% for radio in form.presets %}
      <div>
        {{ radio.tag() }}
        {% if radio.choice_value == 'custom' %}
          {{ form.payment_amount }}
        {% else %}
          <label for="{{radio.id_for_label}}">{{radio.choice_label}}</label>
        {% endif %}
      </div>
    {% endfor %}
  </div>
  <div id="button-container">
    <input type="submit" value="Donate" />
  </div>
</form>

<div id="description">
    {{project.description|safe}}
</div>
{% endblock %}
